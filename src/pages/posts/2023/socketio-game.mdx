---
title: Upgrade a simple HTML, CSS and JS site to a WebSocket application
description: This is a short blog on implementing socket.io with an existing HTML, CSS and JS site.
ideaDate: Jan 22, 2023
---
import BlogImage from '@components/BlogImage.astro'
import PlantUML from '@components/PlantUML.astro'

## Intro

Sarvesh, one of my friends, created a gaming project called "Pig Game" during his Javascript learning journey. 
It is a basic site built using HTML, CSS, and JS in which two people compete by rolling a die. 

At any moment, you have two options: roll the dice to increase your score or give up so that the next person may play. 
The catch is that if the dice stop at **1**, your current score becomes **0**, and the game is passed to the next player.
But if you willingly pass the game to the next person, your current score gets added to the total score which ultimately saves your hard work.

For the time being, this game is only a static web page with all of its capabilities running in the browser.
And because of this, it is unplayable if you are not in the same room (or virtually sharing the screen of the host).
We want to make this a server-based game so that we may play together even from afar.

Here, let's implement a WebSocket server using express.js & socket.io. Also, we'll configure the front-end to establish a connection with this server.

## WebSocket protocol

### HTTP
Let's have a bird-eye view of the traditional `HTTP` protocol. 
With `HTTP`, a client sends a request to the server and the server process the request and sends a response in return. 
The connection is then closed after this request-response cycle. 
`HTTP` is stateless and because it runs on TCP, data delivery is ensured. 

> A stateless protocol does not require the server to retain information or status about each user for the duration of multiple requests. -- wikipedia

You will be required to use cookies or server-side sessions to not forget the user in an `HTTP` protocol. 

<PlantUML context="">
    ```plantuml alt=Websocket Protocol, width=90%
        node Server
        actor Client

        Server <-right- "Client" : request

    ```
    ```plantuml alt=Websocket Protocol, width=90%
        node Server
        actor Client

        Server -right-> "Client" : response

    ```
    ```plantuml alt=Websocket Protocol, width=90%
        node Server
        actor Client

        Server .right. "Client" : connection terminated

    ```
</PlantUML>

### WebSocket

WebSocket is a bidirectional communication between server and client.
Here, both the server and client are allowed to send information to each other while remembering their identity.
The connection will be closed only when either client or server decides to close the connection. 

<PlantUML context="First, a client requests that the server connects to it. Following a specific secret exchanged between them, a hidden consistent tunnel is established.">
    ```plantuml alt=Websocket Protocol, width=90%
        node Server
        actor Client

        Server <-right- "Client" : request

    ```
    ```plantuml alt=Websocket Protocol, width=90%
        node Server
        actor Client

        Server -right-> "Client" : handshake

    ```
    ```plantuml alt=Websocket Protocol, width=90%
        node Server
        actor Client

        Server <-right-> "Client" : WebSocket connected

    ```
</PlantUML>

WebSocket provides a huge performance bump in the case of high-frequency data transfers because the connection time reduces to zero.

> A continuous connection demands battery power. You should be cautious while connecting to a WebSocket with a mobile device. 

And I'm not suggesting you forcefully close your Instagram (or any other messaging app) after each run. 
This caution is required during the designing phase. 
The client and server should be designed to prevent an instance from running for a longer period while keeping it long enough not to terminate earlier than required.

## Pig Game (initially)

